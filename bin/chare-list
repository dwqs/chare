#!/usr/bin/env node

let chalk = require('chalk');
let ora = require('ora');
let request = require('request');

/**
 * Padding
 */
console.log();
let spinner = ora('loading');
spinner.start();

process.on('exit', function () {
    console.log()
});

/**
 * List repos.
 */

request({
    url: 'https://api.github.com/users/waka-templates/repos',
    headers: {
        'User-Agent': 'chare-cli'
    }
}, (err, res, body) => {
    spinner.stop();
    if(err){
        console.error(chalk.red('chare cli:download repos failed.'));
        process.exit(1);
    }
    let requestBody = JSON.parse(body);
    if (Array.isArray(requestBody)) {
        console.log('  Available official templates:');
        console.log();
        requestBody.forEach(function (repo) {
            console.log(
                '  ' + chalk.yellow('*') +
                '  ' + chalk.blue(repo.name) +
                ' - ' + repo.description)
        });
    } else {
        console.error(chalk.red(requestBody.message));
    }
});


